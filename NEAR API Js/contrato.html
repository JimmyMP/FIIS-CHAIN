<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BlockChange</title>
  <script src="https://cdn.jsdelivr.net/npm/near-api-js@0.45.1/dist/near-api-js.min.js"></script>
  <script src="styles.css"></script>
</head>

<body>
    <nav style="height: 50px; background-color: #FFD119; display: flex; align-items: center; width:100%; border: 1px solid black;">
      <div style="padding: 10px 20px"><img src="media/logo.png" alt="Logo" style="width: 50px; height: 50px;"></div>
      <div style="flex-grow: 1; display: flex; justify-content: center;">
        <a href="#" style="margin: 0 10px; text-decoration:none;">Home</a>
        <a href="#" style="margin: 0 10px; text-decoration:none;">Nosotros</a>
        <a href="#" style="margin: 0 10px; text-decoration:none;">Objetivos</a>
        <a href="#" style="margin: 0 10px; text-decoration:none;">Novedades</a>
        <a href="#" style="margin: 0 10px; text-decoration:none;">Voluntariado</a>
        <a href="#" style="margin: 0 10px; text-decoration:none;">Contacto</a>
      </div>
      <div style="padding: 10px 20px"><button style="background-color: #4CAF50; color: white; padding: 10px 20px; border: none; cursor: pointer;">Login</button></div>
    </nav>
  <hr />

  <h1 style="text-align: center; font-weight: bold; font-family: Racing Sans One, sans-serif;">CAUSAS BENÉFICAS</h1>
  
  <div style="width: 50%; display: flex; justify-content: center; gap: 40px; flex-wrap:wrap; margin: 0 auto;">
    <div style=" display: flex; align-items: center;gap: 40px;">
      <img src="media/proyecto1.jpg" alt="Proyecto 1" style="width: 200px; height: 200px;">
      <button onclick="openModal('proyecto1')" style="cursor: pointer;background-color: #EF0DE7; color: white; font-weight: bold; border: 1px solid black;height:55px; width: 105px;font-size:x-large">
        Donar
      </button>
    </div>
    <div style="display: flex; align-items: center;gap: 40px;">
      <img src="media/proyecto2.jpg" alt="Proyecto 2" style="width: 200px; height: 200px;">
      <button onclick="openModal('proyecto2')" style=" cursor: pointer;background-color: #EF0DE7; color: white; font-weight: bold; border: 1px solid black;height:55px; width: 105px;font-size:x-large">
        Donar
      </button>
    </div>
    <div style=" display: flex; align-items: center;gap: 40px;">
      <img src="media/proyecto3.jpg" alt="Proyecto 3" style="width: 200px; height: 200px;">
      <button onclick="openModal('proyecto3')" style=" cursor: pointer;background-color: #EF0DE7; color: white; font-weight: bold; border: 1px solid black;height:55px; width: 105px;font-size:x-large">
        Donar
      </button>
    </div>
    <div style=" display: flex; align-items: center;gap: 40px;">
      <img src="media/proyecto4.jpg" alt="Proyecto 4" style="width: 200px; height: 200px;">
      <button onclick="openModal('proyecto4')" style=" cursor: pointer;background-color: #EF0DE7; color: white; font-weight: bold; border: 1px solid black;height:55px; width: 105px;font-size:x-large">
        Donar
      </button>
    </div>
  </div>

  <div id="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 999;">
    <div style="background-color: white; width: 600px; height: 500px; margin: 100px auto; padding: 20px;">
      <h2 id="modal-title" style="text-align: center;"></h2>
      <p id="modal-description"></p>

      <div style="display: flex; flex-direction: column; align-items: center; margin-top: 20px;">
        <input type="text" id="donation-nombre" placeholder="Ingrese nombre" style="margin-bottom: 10px;">
        <input type="text" id="donation-amount" placeholder="Ingrese la cantidad a donar" style="margin-bottom: 10px;">
        <p>Nota: Se aceptan donaciones a partir de 1000000000000000000000000 = 1 NEAR en adelante.</p>
        <button id="donar" onclick="donate()" style="background-color: #4CAF50; color: white; padding: 10px 20px; border: none; cursor: pointer;">Donar</button>
      </div>
      <button onclick="closeModal()" style="background-color: #4CAF50; color: white; padding: 10px 20px; border: none; cursor: pointer; margin-top: 20px;">Cerrar</button>
    </div>
  </div>

  <script>
    function openModal(proyecto) {
      const modal = document.getElementById('modal');
      const title = document.getElementById('modal-title');
      const description = document.getElementById('modal-description');

      // Set the title and description based on the selected project
      switch (proyecto) {
        case 'proyecto1':
          title.textContent = 'Girl Up';
          description.textContent = 'El mundo necesita nuevas soluciones y liderazgo ahora. Girl Up está ampliando las habilidades, los derechos y las oportunidades de liderazgo de las niñas. Estamos cambiando la cara del liderazgo para las generaciones venideras.';
          break;
        case 'proyecto2':
          title.textContent = 'Woman Intech Perú';
          description.textContent = 'Somos una comunidad dinámica e inclusiva dedicada a fomentar el empoderamiento, la diversidad y la innovación dentro del sector tecnológico. Si eres una profesional experimentada, una estudiante que aspira a ingresar al campo de la tecnología o una apasionada defensora de la igualdad de género, Women in Tech Perú te da la bienvenida. A través de eventos de networking, programas de mentoría e iniciativas de desarrollo de habilidades, para sobresalir en carreras relacionadas con la tecnología y dar forma al futuro de la industria tecnológica en Perú y más allá.';
          break;
        case 'proyecto3':
          title.textContent = 'Girls Who Code';
          description.textContent = 'Girls Who Code es una organización que valora la diversidad, la equidad y la inclusión como esenciales para nuestra misión.';
          break;
        case 'proyecto4':
          title.textContent = 'WOMEN IN STEM';
          description.textContent = 'Nuestro programa de tutoría empareja a profesionales de STEM y estudiantes universitarios con estudiantes individuales de secundaria actuales en función de intereses y objetivos compartidos. Los mentores se reunirán con su aprendiz una o dos veces al mes para una reunión de Zoom de 30 minutos. Esto se programará en función de los horarios disponibles del mentor y el aprendiz y es flexible. La red de mujeres de WiSTEM de todas las edades, carreras e intereses es nuestro recurso más importante. Poder conectar con otros estudiantes como tú y mujeres en diferentes etapas de todos los campos STEM es una gran oportunidad de crecimiento y colaboración.';
          break;
        default:
          title.textContent = '';
          description.textContent = '';
          break;
      }

      modal.style.display = 'block';
    }

    function closeModal() {
      const modal = document.getElementById('modal');
      modal.style.display = 'none';
    }
  </script>
  
  
  <div style="display: flex; justify-content: center; align-items: center; flex-direction: column; margin-top: 280px;">
    <button id="eliminar">Eliminar Proyecto</button>
    <input type="text" id="eliminar-cuenta" placeholder="cuenta" />
    <br />
    <button id="registrar">Registrar Proyecto</button>
    <input type="text" id="registrar-nombre" placeholder="nombre" />
    <input type="text" id="registrar-descripcion" placeholder="descripcion" />
    <input type="number" id="registrar-monto" placeholder="monto" />
    <br />
    <button id="obtener">Obtener Proyecto</button>
    <input type="text" id="obtener-cuenta" placeholder="cuenta" />
    <br />
    <button id="obtener-todos">Obtener Todos los Proyectos</button>
    <br />
    <button id="completar">Completar proyecto</button>
    <input type="text" id="completar-cuenta" placeholder="cuenta" />
  </div>

  <script>
    (async () => {
      const { connect, keyStores, WalletConnection, Contract } = nearApi;

      const CONTRACT_ID = 'jimmymp1379.testnet';



      const NETWORK = 'testnet';
      function config(network = NETWORK) {
        return {
          testnet: {
            networkId: 'testnet',
            keyStore: new keyStores.BrowserLocalStorageKeyStore(),
            nodeUrl: 'https://rpc.testnet.near.org',
            walletUrl: 'https://testnet.mynearwallet.com/',
            helperUrl: 'https://helper.testnet.near.org',
            explorerUrl: 'https://testnet.nearblocks.io'
          },
          mainnet: {
            networkId: 'mainnet',
            keyStore: new keyStores.BrowserLocalStorageKeyStore(),
            nodeUrl: 'https://rpc.mainnet.near.org',
            walletUrl: 'https://wallet.mainnet.near.org',
            helperUrl: 'https://helper.mainnet.near.org',
            explorerUrl: 'https://nearblocks.io'
          }
        }[network];
      }

      const near = await connect(config());
      const wallet = new WalletConnection(near, `${NETWORK}-custom-prefix`); // supports logging in with different keys on the same domain



      const contract = new Contract(wallet.account(), CONTRACT_ID, {
        viewMethods: ['get_proyecto', 'get_proyectos'],
        changeMethods: ['eliminar_proyecto', 'set_proyecto', 'set_completado','donar_proyecto']
      });

      const dom = setupDOMBindings();
      if (wallet.isSignedIn()) {
        dom.btnEliminar.addEventListener('click', async () => {
            console.log('eliminando cuenta');
            await contract.eliminar_proyecto({ cuenta: dom.txtEliminarCuenta.value });
            console.log('cuenta eliminada');
        });

        dom.btnDonar.addEventListener('click', async () => {
          console.log('donado cuenta');
          await contract.donar_proyecto({
        meta: "some info",
        args: {
            nombre: dom.txtDonanteNombre.value,
        },
        amount: dom.txtDonacion.value
          });
          alert('Donación realizada con éxito');
      });

        dom.btnRegistrar.addEventListener('click', async () => {
            console.log('agregando cuenta');
            await contract.set_proyecto({
          meta: "some info",
          args: {
              nombre: dom.txtRegistrarNombre.value,
              descripcion: dom.txtRegistrarDescripcion.value,
              monto_total: parseInt(dom.txtRegistrarMonto.value)*1000000000000000000000000         
          },
          amount: '1000000000000000000000000'
            });
            console.log('cuenta agregada');
        });

        dom.btnObtener.addEventListener('click', async () => {
          const participante = await contract.get_proyecto({ cuenta: dom.txtObtenerCuenta.value });
          console.log(participante);
        });

        dom.btnObtenerTodos.addEventListener('click', async () => {
          try {
            const participantes = await contract.get_proyectos();
            console.log(participantes);
            } catch (e) {
                console.error('Error al eliminar proyecto:', e);
            }
        });

        dom.btnCompletar.addEventListener('click', async () => {
          await contract.set_completado({ cuenta: dom.txtCompletarCuenta.value });
        });
      }

      function setupDOMBindings() {
        return {
          btnEliminar: document.querySelector('#eliminar'),
          txtEliminarCuenta: document.querySelector('#eliminar-cuenta'),

          btnRegistrar: document.querySelector('#registrar'),
          txtRegistrarNombre: document.querySelector('#registrar-nombre'),
          txtRegistrarDescripcion: document.querySelector('#registrar-descripcion'),
          txtRegistrarMonto: document.querySelector('#registrar-monto'),

          btnObtener: document.querySelector('#obtener'),
          txtObtenerCuenta: document.querySelector('#obtener-cuenta'),

          btnObtenerTodos: document.querySelector('#obtener-todos'),

          btnCompletar: document.querySelector('#completar'),
          txtCompletarCuenta: document.querySelector('#completar-cuenta'),

          txtDonanteNombre: document.querySelector('#donation-nombre'),
          btnDonar: document.querySelector('#donar'),
          txtDonacion: document.querySelector('#donation-amount')
        };
      }
    })();
  </script>
  <script>
    (async () => {
      const NETWORK = 'testnet';

      const { connect, keyStores, WalletConnection } = nearApi;

      const button = document.querySelector('button');

      const near = await connect(config());
      const wallet = new WalletConnection(near, `${NETWORK}-custom-prefix`); // supports logging in with different keys on the same domain

      if (wallet.isSignedIn()) {
        const accountId = wallet.getAccountId();
        button.innerHTML = `Cerrar Sesión`;
        button.addEventListener('click', signOut);
      } else {
        button.addEventListener('click', signIn);
      }

      // ----------------
      // Helper functions
      // ----------------

      function signIn() {
        wallet.requestSignIn({
          contractId: NETWORK === 'testnet' ? 'unv.testnet' : 'unv.near',
          methodNames: []
        });
      }

      function signOut() {
        wallet.signOut();
        button.innerHTML = 'Login';
      }

      function config(network = NETWORK) {
        return {
          testnet: {
            networkId: 'testnet',
            keyStore: new keyStores.BrowserLocalStorageKeyStore(),
            nodeUrl: 'https://rpc.testnet.near.org',
            walletUrl: 'https://testnet.mynearwallet.com/',
            helperUrl: 'https://helper.testnet.near.org',
            explorerUrl: 'https://testnet.nearblocks.io'
          },
          mainnet: {
            networkId: 'mainnet',
            keyStore: new keyStores.BrowserLocalStorageKeyStore(),
            nodeUrl: 'https://rpc.mainnet.near.org',
            walletUrl: 'https://wallet.mainnet.near.org',
            helperUrl: 'https://helper.mainnet.near.org',
            explorerUrl: 'https://nearblocks.io'
          }
        }[network];
      }
    })();
  </script>
</body>

</html>
